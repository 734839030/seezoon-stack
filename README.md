![seezoon](doc/pictures/logo.png)

## ç®€ä»‹

**Seezoon Stack** ä»¥**å¿«é€Ÿå¼€å‘**ä¸ºç›®çš„ï¼Œåœ¨å¼€å‘é€Ÿåº¦å’Œä»£ç ç»“æ„ä¸Šåšå‡ºä¸€å®šå–èˆï¼Œæ— è®ºå¦‚ä½•ï¼Œä½ å°†çœ‹åˆ°**éå¸¸åœ°é“**çš„ Java
å¸¸ç”¨å¼€å‘æ¡†æ¶ä½¿ç”¨ã€‚è¯¥é¡¹ç›®é‡‡ç”¨ä¸»æµå¼€å‘æ¡†æ¶ï¼Œæ— è®ºæ‰“åŒ…ã€ç¼–è¯‘ã€éƒ¨ç½²éƒ½æŒ‰ç€å¤§å…¬å¸çš„æ ‡å‡†å®Œæˆå¹¶ä¸æ–­é€æ­¥å®Œå–„ã€‚

## ğŸ’» åœ¨çº¿æ¼”ç¤º

**è¯¦ç»†æ–‡æ¡£åŠæ¼”ç¤ºåœ°å€ï¼š**  [https://doc.stack.seezoon.com](https://doc.stack.seezoon.com)

è´¦å·ï¼šadmin

å¯†ç ï¼š123456


éƒ¨åˆ†æ•ˆæœå›¾ï¼š

<img src="doc/pictures/image-20210422205522263.png" alt="image-20210422205522263" style="zoom:50%;" />

<img src="doc/pictures/image-20210422205553804.png" alt="image-20210422205553804" style="zoom:50%;" />

<img src="doc/pictures/image-20210422205738456.png" alt="image-20210422205738456" style="zoom:50%;" />

## æŠ€æœ¯é€‰å‹

**Seezoon Stack** é‡‡ç”¨å½“ä¸‹æœ€å‰æ²¿å‰åç«¯çš„æŠ€æœ¯æ ˆå®Œæˆã€‚

åå°**ä¸»è¦**æ¡†æ¶ï¼š

| æ¡†æ¶åç§°                  | æ¡†æ¶åœ°å€                                             | è¯´æ˜           |
| ------------------------- | ---------------------------------------------------- | -------------- |
| Spring Boot               | https://spring.io/projects/spring-boot               | è‡ªåŠ¨è£…é…       |
| Spring Session Data Redis | https://spring.io/projects/spring-session-data-redis | ç™»å½•æ€ç®¡ç†     |
| Spring Security           | https://spring.io/projects/spring-security           | ç™»å½•åŠæƒé™æ§åˆ¶ |
| Mybatis                   | https://mybatis.org/mybatis-3/zh/index.html          | æŒä¹…å±‚         |
| Springfox                 | https://github.com/springfox/springfox               | openAPI 3 æ–‡æ¡£ |

## ç‰¹æ€§

- JSR303 éªŒè¯ã€æ ‡å‡†APIæ¨¡å‹ï¼Œé”™è¯¯ç ã€å¼‚å¸¸å¤„ç†å°è£…
- è¯·æ±‚åŸ‹ç‚¹ï¼Œè¿”å›å¤´æ·»åŠ `X-Trace-Id`ï¼Œé€šè¿‡`MDC`åœ¨æ—¥å¿—ä¸­åŸ‹å…¥çº¿ç¨‹ID;
- Redis å°è£…ï¼Œåºåˆ—åŒ–
- RestTemplate çº¿ç¨‹æ± ã€è¯ä¹¦è¯·æ±‚åŠé»˜è®¤å±æ€§çº¦å®š
- Spring Boot å¼‚æ­¥çº¿ç¨‹é…ç½®
- è·¨åŸŸæ”¯æŒ
- åŸºäºopenAPI 3.0 è§„èŒƒçš„è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£
- å‰åç«¯ä¸€ä½“åŒ–ä»£ç ç”Ÿæˆ
- ç™»å½•åŠæƒé™æ§åˆ¶
- æ–‡ä»¶å¤„ç†ï¼Œæ”¯æŒç£ç›˜æ–‡ä»¶å’Œé˜¿é‡Œäº‘OSS
- å›½é™…åŒ–
- é€šç”¨æ•°æ®æƒé™
- åŠ¨æ€èœå•&æŒ‰é’®

ä¼˜å…ˆçº§è¾ƒä½çš„åŠŸèƒ½(TODO)ï¼š

- é˜¿é‡Œäº‘çŸ­ä¿¡
- Excel å¤„ç†
- å¾®ä¿¡å…¬ä¼—å·ã€å°ç¨‹åºç›¸å…³ï¼Œç™»å½•ï¼Œæ”¯ä»˜ç­‰å¸¸ç”¨å°è£…
- äº‘åŸç”Ÿéƒ¨ç½²åŠç¼–æ’æ–‡æ¡£

å‰å°**ä¸»è¦**æ¡†æ¶ï¼š

| æ¡†æ¶åç§°         | æ¡†æ¶åœ°å€                                        | è¯´æ˜            |
| ---------------- | ----------------------------------------------- | --------------- |
| Vue 3            | https://v3.cn.vuejs.org/guide/introduction.html | åŒå‘ç»‘å®š        |
| Vite             | https://cn.vitejs.dev/                          | æ„å»ºå·¥å…·        |
| Ant Design Vue 2 | https://2x.antdv.com/components/overview-cn/    | ç»„ä»¶            |
| TypeScript 4     | https://www.typescriptlang.org/zh/              | JavaScript è¶…é›† |
| Windi Css        | https://windicss.org/guide/                     | css è¾…åŠ©ç±»      |
| Iconify          | https://iconify.design/                         | å›¾æ ‡åº“          |

å‰ç«¯æ¡†æ¶ fork  [Vue vben admin 2.0](https://vvbin.cn/doc-next/)ï¼Œå®šæœŸä¼šåˆå¹¶ä¸Šæ¸¸ç‰¹æ€§ï¼Œå…·ä½“ç»„ä»¶è¯·å‚è€ƒ Vben admin æ–‡æ¡£ã€‚åœ¨æ­¤ä¹Ÿæ„Ÿè°¢Vben admin å¯¹è¯¥é¡¹ç›®æä¾›çš„å¸®åŠ©ã€‚

å‰ç«¯ä¸»è¦é‡‡ç”¨Ant Design Vue 2 ä½œä¸ºä¸»è¦ç»„ä»¶åº“ï¼Œé™ä½å­¦ä¹ æˆæœ¬ï¼Œä¸»ä½“æ¡†æ¶å‡ä¸ºTypeScriptï¼Œä¸šåŠ¡åŠŸèƒ½é‡‡ç”¨JavaScriptç¼–å†™ï¼Œé’ˆå¯¹å¿«é€Ÿå¼€å‘JavaScript ä»£ç é‡è¾ƒä¸ºç®€æ´ï¼Œé€Ÿåº¦è¾ƒå¿«ã€‚

## ç¯å¢ƒå‡†å¤‡

- JDK 1.8 + ï¼ˆå»ºè®®11ï¼‰
- Maven 3 +
- Node 12 +
- Yarnï¼ˆå®‰è£…å®Œnodeï¼Œå¯ç”¨`npm install -g yarn`ï¼‰
- Redis
- Mysql 5.7 + (å»ºè®®8)

## ğŸš€ å¿«é€Ÿå¼€å§‹

**ä»£ç ä¸‹è½½**

å¯ä»¥é€šè¿‡ IDEA `File->New->Project From Version Control `å¯¼å…¥ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤ä¸‹è½½åå¯¼å…¥ã€‚

> å»ºè®®fork ååˆ°è‡ªå·±ä»“åº“åå†å¯¼å…¥ï¼Œæ–¹ä¾¿åç»­åŒæ­¥æ›´æ–°ã€‚

```
git clone https://github.com/734839030/seezoon-stack.git
```

**å·¥ç¨‹ç»“æ„**

```
â€‹```
.
â””â”€â”€ seezoon-stack   parentå·¥ç¨‹
    â”œâ”€â”€ build æ„å»ºæ‰€éœ€æ–‡ä»¶
    â”‚   â”œâ”€â”€ assembly    ç”Ÿæˆäº§å‡ºç‰©ç»“æ„
    â”‚   â”‚   â”œâ”€â”€ bin     é¡¹ç›®è„šæœ¬
    â”‚   â”‚   â”œâ”€â”€ conf    é…ç½®ç›®å½•
    â”‚   â”‚   â”œâ”€â”€ logs    æ—¥å¿—ç›®å½•
    â”‚   â”‚   â””â”€â”€ assembly.xml     maven assembly æ‰“åŒ…æ’ä»¶æè¿°æ–‡ä»¶(ä¸æ‰“åŒ…åˆ°äº§å‡ºç‰©)
    â”‚   â”œâ”€â”€ build.sh    æ„å»ºè„šæœ¬
    â”‚   â”œâ”€â”€ eclipse-codestyle.xml  P3Cä»£ç æ ¼å¼,å¯ä»¥è‡ªè¡Œæ›´æ–°
    â”‚   â”œâ”€â”€ maven-settings.xml     mavençš„settingé…ç½®(å¯é€‰)
    â”‚   â””â”€â”€ mybatis-generator-config.xml  åŸç”Ÿmybatis-generator æè¿°æ–‡ä»¶(å¯é€‰)
    â”œâ”€â”€ db DBè„šæœ¬ç›®å½•
    â”œâ”€â”€ doc é¡¹ç›®æ–‡æ¡£åŠèµ„æ–™ç»´æŠ¤ç›®å½•
    â”œâ”€â”€ seezoon-admin-server  ç®¡ç†ç«¯æœåŠ¡
    â”œâ”€â”€ seezoon-admin-web  åå°é¡µé¢ç›®å‰forkä¸Šæ¸¸,ä»£ç åº“å•ç‹¬ç»´æŠ¤ç¨³å®šååˆå¹¶
    â”œâ”€â”€ seezoon-dao    DAOå±‚ï¼Œæ–¹ä¾¿ç®¡ç†ç«¯å’ŒCç«¯å¼•ç”¨
    â”œâ”€â”€ seezoon-framework  ç®¡ç†ç«¯å’ŒCç«¯é€šç”¨æ¡†æ¶å±‚(åŸºç¡€ä¸­é—´ä»¶,å‚æ•°éªŒè¯ï¼Œå®‰å…¨æ§åˆ¶)
    â”œâ”€â”€ seezoon-generator  é€šç”¨ä»£ç ç”Ÿæˆå™¨ï¼Œå¯ä»¥å•ç‹¬ä½¿ç”¨ä¹Ÿå¯ä»¥ä¾›å…¶ä»–ç»„ä»¶ç»§æ‰¿ä½¿ç”¨
    â””â”€â”€ seezoon-user-server  Cç«¯æœåŠ¡ç«¯TODO
â€‹```
```

### åå°

- **åˆå§‹åŒ–DBè„šæœ¬**

  è„šæœ¬è§`db/seezoon-stack.sql`

- **é…ç½®seezoon-admin-server**

  åœ¨å¦‚ä¸‹é…ç½®æ–‡ä»¶é…ç½®**DB**å’Œ**Redis**è´¦å·å¯†ç 

  `seezoon-admin-server/src/main/resources/application-local.properties`

- **IDEAä¸­å¯åŠ¨åå°**

> æ‰§è¡Œå¦‚ä¸‹ç±»ä¸­Mainæ–¹æ³•(å¦‚æœæŠ¥ä¾èµ–é”™è¯¯ï¼Œå¯ä»¥æ‰§è¡Œparent å·¥ç¨‹mvn package)

â€‹      `seezoon-admin-server/src/main/java/com/seezoon/admin/AdminMain.java`

### å‰å°

- **å®‰è£…ä¾èµ–å¹¶å¯åŠ¨**

  ```
  cd seezoon-stack/seezoon-admin-web
  yarn install
  yarn serve 
  
  # è®¿é—®åœ°å€
  http://localhost:3100/
  ```

- **æœ¬åœ°æµ‹è¯•æ–‡ä»¶æœåŠ¡å™¨(å¯é€‰)**

  ```
  cd seezoon-admin-web/test/server/upload
  yarn install
  yarn start
  
  # ç®¡ç†ç«¯ä¸Šä¼ æ–‡ä»¶åï¼Œå¯ä»¥ç›´æ¥è®¿é—®åœ°å€staticç›®å½•é™æ€æ–‡ä»¶
  http://localhost:3001/static/xxxx
  ```

## ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

çº¿ä¸Šç›®å½•ç»“æ„ï¼Œ

```
/data/
â”‚â”€â”€ cert
â”œâ”€â”€ seezoon-admin-server  # åå°äº§å‡ºç‰©
â”‚   â”œâ”€â”€ bin
â”‚   â”œâ”€â”€ conf
â”‚   â”œâ”€â”€ logs
â”‚   â””â”€â”€ work
â”œâ”€â”€ seezoon-admin-web    # å‰ç«¯äº§å‡ºç‰©
â”‚   â”œâ”€â”€ assets
â”‚   â””â”€â”€ resource
â””â”€â”€ upload-server  æ–‡ä»¶ä¸Šä¼ ç›®å½•ï¼Œé»˜è®¤ä½¿ç”¨ç£ç›˜æ–‡ä»¶ï¼Œä½¿ç”¨OSSåˆ™ä¸éœ€è¦.
```

### ğŸ˜‡ æ‰‹å·¥éƒ¨ç½²-åå°

> çº¿ä¸Šç¯å¢ƒå®‰è£…Java 1.8 + ï¼Œæ¨è11ã€‚

é‡‡ç”¨[maven-assembly-plugin](http://maven.apache.org/plugins/maven-assembly-plugin/)ç”Ÿæˆæ„å»ºç‰©ï¼Œå¯ä»¥ç›´æ¥ç”Ÿæˆç”Ÿäº§éƒ¨ç½²çš„ç›®å½•ç»“æ„ï¼Œæ–¹ä¾¿DevOps é›†æˆ.

```
cd seezoon-admin-server
mvn clean package
```

**äº§å‡ºç‰©ç›®å½•**

`seezoon-admin-server/target/seezoon-admin-server`

**åªéœ€è¦ç»´æŠ¤äº§å‡ºç‰©`conf `ç›®å½•çš„`application.properties `å³å¯**ï¼Œç„¶åå°±å¯ä»¥å‘å¸ƒäº†ã€‚

> é…ç½®æ–‡ä»¶ä¸ç¯å¢ƒåˆ†ç¦»ï¼Œ`maven-jar-plugin` æ‰“åŒ…äº§å‡ºç‰©`jar`ä¼šæ’å‡º`resources`ç›®å½•å¦‚ä¸‹æ–‡ä»¶ï¼š

```
application-local.properties
logback-spring.xml
```

> å¦‚æœä¸ä»‹æ„å„ä¸ªç¯å¢ƒé…ç½®éƒ½åœ¨å·¥ç¨‹ä¸­é‚£å°±å¾ˆæ–¹ä¾¿ï¼Œä½¿ç”¨spring boot æä¾›çš„`--spring.profiles.active`ï¼Œåœ¨å¯åŠ¨å‘½ä»¤ä¸­é€‰æ‹©é…ç½®æ–‡ä»¶ã€‚

<img src="doc/pictures/image-20210423121842460.png" alt="image-20210423121842460" />

### ğŸ˜‡ æ‰‹å·¥éƒ¨ç½²-å‰å°

```
cd seezoon-admin-web
yarn build
```

**äº§å‡ºç‰©**

`seezoon-admin-web/dist` ä¸­æ–‡ä»¶å‘å¸ƒåˆ°çº¿ä¸Šnginx ç›®å½•å³å¯ï¼Œè¯¥å·¥ç¨‹nginx é…ç½®å¦‚ä¸‹ï¼Œä»…ä¾›å‚è€ƒã€‚

```
upstream seezoon-admin-server {
    server 127.0.0.1:8080 max_fails=3 fail_timeout=10s;
}

server {
    listen       80;
    server_name  stack.seezoon.com;
    rewrite ^(.*)$  https://$host$1 permanent;
}

server {
    listen       443;
    server_name  stack.seezoon.com;
    ssl on;
    ssl_certificate   /data/cert/stack.seezoon.com.pem; 
    ssl_certificate_key  /data/cert/stack.seezoon.com.key;
    ssl_session_timeout 5m;
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;
    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
    ssl_prefer_server_ciphers on;

    # api
    location ^~ /api/ {
        proxy_redirect off;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Real-PORT $remote_port;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://seezoon-admin-server/;
    }
    # æ–‡ä»¶æœåŠ¡
    location ^~ /file/ {
        access_log off;
        alias /data/upload-server/;
    }

    # é™æ€èµ„æº
    location / {
        access_log off;
        root /data/seezoon-admin-web/;
        index index.html index.htm;
    }

}
```

> å¯é€‰é™æ€èµ„æºå‹ç¼©é…ç½®ï¼Œæ”¾åœ¨`nginx.conf http` èŠ‚ç‚¹ä¸‹ã€‚

```
# æ‰“å¼€gzip æ•ˆæœæ›´ä½³
gzip on;
gzip_min_length 1k;
gzip_buffers 4 16k;
gzip_http_version 1.0;
gzip_comp_level 6;
gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;
gzip_vary off;
gzip_disable "MSIE [1-6]\.";
```



## å¦‚ä½•è´¡çŒ®

éå¸¸æ¬¢è¿ä½ çš„åŠ å…¥ï¼[æä¸€ä¸ª Issue](https://github.com/734839030/seezoon-stack/issues/new) æˆ–è€…æäº¤ä¸€ä¸ª Pull Requestã€‚

**Pull Requestï¼š**

1. Fork ä»£ç ! (åŒæ­¥ä¸Šæ¸¸ï¼šgit pull https://github.com/734839030/seezoon-stack.git master)
2. åˆ›å»ºè‡ªå·±çš„åˆ†æ”¯: `git checkout -b feat/xxxx`
3. æäº¤ä½ çš„ä¿®æ”¹: `git commit -m 'feat(function): add xxxxx'`
4. æ¨é€æ‚¨çš„åˆ†æ”¯: `git push origin feat/xxxx`
5. æäº¤`pull request`

## Git è´¡çŒ®æäº¤è§„èŒƒ

å‚è€ƒè§„èŒƒ ([Angular](https://github.com/conventional-changelog/conventional-changelog/tree/master/packages/conventional-changelog-angular))

    - `feat` å¢åŠ æ–°åŠŸèƒ½
    - `fix` ä¿®å¤é—®é¢˜/BUG
    - `style` ä»£ç é£æ ¼ç›¸å…³æ— å½±å“è¿è¡Œç»“æœçš„
    - `perf` ä¼˜åŒ–/æ€§èƒ½æå‡
    - `refactor` é‡æ„
    - `revert` æ’¤é”€ä¿®æ”¹
    - `test` æµ‹è¯•ç›¸å…³
    - `docs` æ–‡æ¡£/æ³¨é‡Š
    - `chore` ä¾èµ–æ›´æ–°/è„šæ‰‹æ¶é…ç½®ä¿®æ”¹ç­‰
    - `workflow` å·¥ä½œæµæ”¹è¿›
    - `ci` æŒç»­é›†æˆ
    - `types` ç±»å‹å®šä¹‰æ–‡ä»¶æ›´æ”¹
    - `wip` å¼€å‘ä¸­

